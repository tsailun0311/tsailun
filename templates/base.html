<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <meta name="theme-color" content="#e7e5e3">
    <meta property="og:image"
        content="https://visualcube.api.cubing.net/visualcube.php?bg=t&fmt=png&size=256&case=U%27F%27L2U2R2B%27DL2D%27B2UF2UF2UR2x2" />
    <meta name="description" content="這個網站包含我的魔方整理和紀錄，無任何營收，主要練習架站。">
    <title>{{title}}</title>
    <link rel="icon"
        href="https://visualcube.api.cubing.net/visualcube.php?bg=t&fmt=png&size=32&case=U%27F%27L2U2R2B%27DL2D%27B2UF2UF2UR2x2"
        sizes="32x32">
    <link rel="apple-touch-icon"
        href="https://visualcube.api.cubing.net/visualcube.php?bg=t&fmt=png&size=256&case=U%27F%27L2U2R2B%27DL2D%27B2UF2UF2UR2x2">
    <link href="//cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href="{{ url_for('static', filename='css/style.less') }}" rel="stylesheet/less" type="text/css">
    <link href="{{ url_for('static', filename='manifest.json') }}" rel="manifest">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.3/less.min.js"></script>
    <script src="{{ url_for('static', filename='js/jquery.min.js') }}" type="text/javascript"></script>
    <script src="//cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    {% block head %}{% endblock %}
</head>

<body>
    <div class="loading-wrapper">
        <div class="d-flex justify-content-center align-items-center" style="height: 100%;">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>
    <div class="top">
        <ul class="menu">
            {% for i in range(5) %}
            <li class="{% if request.path == menu[0][i] %}active{% endif %}"><a href="{{menu[0][i]}}" {% if
                    loop.index0==2 %} id="home" data-home-url="{{ menu[0][i] }}" {% endif %}>{{menu[1][i]}}</a>
            </li>
            {% endfor %}
        </ul>
    </div>
    <div id="mainer">
        {% block content %}{% endblock %}
    </div>
    <script>
        $(document).ready(function () {
            $(".loading-wrapper").fadeOut(500);
        });
        $(function () {
            const $homeBtn = $('#home');
            if (!$homeBtn.length) return;
            const homeUrl = $homeBtn.data('home-url');
            const homeIcon = '<i class="bi bi-house-fill"></i>';
            const topIcon = '<i class="bi bi-chevron-double-up"></i>';
            function updateHomeBehavior() {
                const scrollPos = $(window).scrollTop();
                if (scrollPos > 10) {
                    $homeBtn.attr('href', '#mainer').html(topIcon);
                } else {
                    $homeBtn.attr('href', homeUrl).html(homeIcon);
                }
            }
            updateHomeBehavior();
            $(window).on('scroll', updateHomeBehavior);
        });
        (function () {
            const topEl = document.querySelector('.top');
            if (!topEl) return;
            let rafId = null;
            function updateCanvasPointerEvents() {
                if (rafId) cancelAnimationFrame(rafId);
                rafId = requestAnimationFrame(() => {
                    const topRect = topEl.getBoundingClientRect();
                    const canvases = document.querySelectorAll('.cube canvas');
                    canvases.forEach(c => {
                        const r = c.getBoundingClientRect();
                        const overlap = !(r.right < topRect.left || r.left > topRect.right || r.bottom < topRect.top || r.top > topRect.bottom);
                        c.style.pointerEvents = overlap ? 'none' : 'auto';
                    });
                });
            }
            ['scroll', 'resize', 'orientationchange', 'touchstart', 'touchmove', 'pointerdown', 'pointermove'].forEach(evt => {
                window.addEventListener(evt, updateCanvasPointerEvents, { passive: true });
            });
            document.addEventListener('DOMContentLoaded', updateCanvasPointerEvents);
            setTimeout(updateCanvasPointerEvents, 500);
            new MutationObserver(updateCanvasPointerEvents).observe(document.body, { childList: true, subtree: true });
        })();
        function stopCubeHandlersOnTop(e) {
            try {
                if (e.target && e.target.closest && e.target.closest('.top')) {
                    e.stopPropagation();
                }
            } catch (err) {
            }
        }
        ['touchstart', 'touchend', 'mousedown', 'mouseup', 'pointerdown', 'pointerup', 'click'].forEach(evt => {
            document.addEventListener(evt, stopCubeHandlersOnTop, { capture: true, passive: false });
        });
    </script>
</body>
<!--  d8'                    888888888888                    88     88
88   d8'                          88                         ""     88
88  ""                            88                                88
88    88,dPYba,,adPYba,           88  ,adPPYba,  ,adPPYYba,  88     88          88       88  8b,dPPYba,
88    88P'   "88"    "8a          88  I8[    ""  ""     `Y8  88     88          88       88  88P'   `"8a
88    88      88      88          88   `"Y8ba,   ,adPPPPP88  88     88          88       88  88       88
88    88      88      88          88  aa    ]8I  88,    ,88  88     88          "8a,   ,a88  88       88
88    88      88      88          88  `"YbbdP"'  `"8bbdP"Y8  88     88888888888  `"YbbdP'Y8  88      -->

</html>